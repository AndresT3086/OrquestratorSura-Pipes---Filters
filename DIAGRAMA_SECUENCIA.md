# ðŸ“Š Diagrama de Secuencia - API Gateway + Lambda

## Flujo de una peticiÃ³n GET /policies
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚Cliente â”‚      â”‚ API Gateway â”‚      â”‚   Lambda    â”‚      â”‚   CÃ³digo     â”‚
â””â”€â”€â”€â”¬â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
    â”‚                  â”‚                     â”‚                    â”‚
    â”‚ GET /policies    â”‚                     â”‚                    â”‚
    â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                     â”‚                    â”‚
    â”‚                  â”‚                     â”‚                    â”‚
    â”‚                  â”‚ Validar request     â”‚                    â”‚
    â”‚                  â”‚ (API Key, CORS)     â”‚                    â”‚
    â”‚                  â”‚                     â”‚                    â”‚
    â”‚                  â”‚ Invocar Lambda      â”‚                    â”‚
    â”‚                  â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                    â”‚
    â”‚                  â”‚                     â”‚                    â”‚
    â”‚                  â”‚                     â”‚ Ejecutar handler() â”‚
    â”‚                  â”‚                     â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚
    â”‚                  â”‚                     â”‚                    â”‚
    â”‚                  â”‚                     â”‚ Consultar datos    â”‚
    â”‚                  â”‚                     â”‚ (En memoria)       â”‚
    â”‚                  â”‚                     â”‚                    â”‚
    â”‚                  â”‚                     â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
    â”‚                  â”‚                     â”‚ Retornar JSON      â”‚
    â”‚                  â”‚                     â”‚                    â”‚
    â”‚                  â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚                    â”‚
    â”‚                  â”‚ Response (200 OK)   â”‚                    â”‚
    â”‚                  â”‚                     â”‚                    â”‚
    â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚                     â”‚                    â”‚
    â”‚ JSON response    â”‚                     â”‚                    â”‚
    â”‚                  â”‚                     â”‚                    â”‚
```

## Flujo POST /policies (crear pÃ³liza)
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      
â”‚Cliente â”‚      â”‚ API Gateway â”‚      â”‚   Lambda    â”‚      
â””â”€â”€â”€â”¬â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜      
    â”‚                  â”‚                     â”‚             
    â”‚ POST /policies   â”‚                     â”‚             
    â”‚ + JSON body      â”‚                     â”‚             
    â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                     â”‚             
    â”‚                  â”‚                     â”‚             
    â”‚                  â”‚ Validar request     â”‚             
    â”‚                  â”‚                     â”‚             
    â”‚                  â”‚ Invocar Lambda      â”‚             
    â”‚                  â”‚ (pasar body)        â”‚             
    â”‚                  â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚             
    â”‚                  â”‚                     â”‚             
    â”‚                  â”‚                     â”‚ Parsear JSON
    â”‚                  â”‚                     â”‚ Validar datos
    â”‚                  â”‚                     â”‚ Crear pÃ³liza
    â”‚                  â”‚                     â”‚ Generar ID  
    â”‚                  â”‚                     â”‚             
    â”‚                  â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚             
    â”‚                  â”‚ 201 Created         â”‚             
    â”‚                  â”‚ + nueva pÃ³liza      â”‚             
    â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚                     â”‚             
    â”‚                  â”‚                     â”‚             
```

## Componentes

1. **Cliente**: Navegador, Postman, app mÃ³vil, etc.
2. **API Gateway**:
    - Valida requests
    - Maneja CORS
    - Rate limiting
    - Transforma requests/responses
3. **Lambda**:
    - Ejecuta lÃ³gica de negocio
    - Sin servidor (serverless)
    - Escala automÃ¡ticamente
    - Solo paga por uso
4. **CÃ³digo Python**:
    - Handler principal
    - Routing por mÃ©todo HTTP
    - Validaciones
    - LÃ³gica CRUD